#!/usr/bin/php
<?php

if (!is_dir(__DIR__ . '/../db')) {
    mkdir(__DIR__ . '/../db');
}

$db = new SQLite3(__DIR__ . '/../db/api.db');

$create_client = <<<EOH
    CREATE TABLE IF NOT EXISTS client (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT,
        authorization TEXT,
        last_request TEXT
    );
EOH;

if ($db->exec($create_client)) {
    echo "New table 'client' created successfully.", PHP_EOL;
} else {
    echo sprintf(
        "An error occurred while attempting to setup the database: %s (%s)%s",
        $db->lastErrorMsg(),
        $db->lastErrorCode(),
        PHP_EOL
    );
}
